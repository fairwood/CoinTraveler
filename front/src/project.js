require=function r(c,i,l){function s(e,t){if(!i[e]){if(!c[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(d)return d(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var a=i[e]={exports:{}};c[e][0].call(a.exports,function(t){return s(c[e][1][t]||t)},a,a.exports,r,c,i,l)}return i[e].exports}for(var d="function"==typeof require&&require,t=0;t<l.length;t++)s(l[t]);return s}({BalanceFormatter:[function(t,e,o){"use strict";cc._RF.push(e,"b0386ICFmpJBqU/vG4m56VJ","BalanceFormatter"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.formatBTC=function(t){if(Math.abs(t)<1e-7)return"0";var e=Math.max(0,Math.floor(Math.log(t)/Math.LN10));return t.toFixed(Math.max(0,5-e))},e.formatNAS=function(t){var e=Math.max(0,Math.floor(Math.log(t)/Math.LN10));return t.toFixed(Math.min(4,Math.max(0,4-e)))},e.formatCNY=function(t){if(Math.abs(t)<.005)return"0";var e=Math.max(0,Math.floor(Math.log(t)/Math.LN10));return t.toFixed(Math.min(2,Math.max(0,4-e)))},e=__decorate([a],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],CoreUI:[function(t,e,o){"use strict";cc._RF.push(e,"b184abFpf1KhoW4BSDEUo5j","CoreUI"),Object.defineProperty(o,"__esModule",{value:!0});var d=t("./MainCtrl"),p=t("./BalanceFormatter"),n=t("./MoneyLabel"),a=cc._decorator,r=a.ccclass,c=a.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fiatBalance=0,t.btcBalance=0,t.t=0,t.isRunning=!1,t.interval=1,t.nextDayCountdown=1e8,t.baseSpeed=1,t.speedMods=[1,5,20,100,500],t.speedersButton=[!1,!1,!1,!1,!1],t.speedersKeyboard=[!1,!1,!1,!1,!1],t.dayWidth=3,t.width=501,t.height=282,t.lblPrice=null,t.lblDate=null,t.grpNews=null,t.lblNews=null,t.lblFiatBalance=null,t.lblBtcBalance=null,t.lblTotalAsCNY=null,t.lblTotalAsBTC=null,t.graphics=null,t.lastOper=null,t.lblLastOper=null,t.highestLine=null,t.currentPriceLine=null,t.lblCurrentPrice=null,t.btnBuyAll=null,t.btnSellAll=null,t.lblSpeed=null,t.btnSpeeds=[],t.lastOperT=null,t.lastOperDir=null,t.lastOperPrice=null,t.newsOpacity=0,t}return __extends(t,e),(s=t).prototype.onLoad=function(){var o=this;this.lblFiatBalance.formatterFunc=function(t){return p.default.formatCNY(t)+"CNY"},this.lblBtcBalance.formatterFunc=function(t){return p.default.formatBTC(t)+"BTC"};for(var t=function(e){var t=n.btnSpeeds[e];t.node.on(cc.Node.EventType.TOUCH_START,function(t){o.speedersButton[e]=!0,o.baseSpeed=o.speedMods[e]}),t.node.on(cc.Node.EventType.TOUCH_END,function(t){o.speedersButton[e]=!1}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(console.log("keyCode",t.keyCode),t.keyCode){case cc.KEY[1]:o.speedersKeyboard[0]=!0,o.baseSpeed=o.speedMods[0];break;case cc.KEY[2]:o.speedersKeyboard[1]=!0,o.baseSpeed=o.speedMods[1];break;case cc.KEY[3]:o.speedersKeyboard[2]=!0,o.baseSpeed=o.speedMods[2];break;case cc.KEY[4]:o.speedersKeyboard[3]=!0,o.baseSpeed=o.speedMods[3];break;case cc.KEY[5]:o.speedersKeyboard[4]=!0,o.baseSpeed=o.speedMods[4]}}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){switch(t.keyCode){case cc.KEY[1]:o.speedersKeyboard[0]=!1;break;case cc.KEY[2]:o.speedersKeyboard[1]=!1;break;case cc.KEY[3]:o.speedersKeyboard[2]=!1;break;case cc.KEY[4]:o.speedersKeyboard[3]=!1;break;case cc.KEY[5]:o.speedersKeyboard[4]=!1}})},n=this,e=0;e<this.btnSpeeds.length;e++)t(e);cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){switch(t.keyCode){case cc.KEY.j:o.BuyAll();break;case cc.KEY.k:o.SellAll()}})},t.prototype.restart=function(){this.fiatBalance=100/s.USD2CNY,this.btcBalance=0,this.t=-1,this.nextDayCountdown=0,this.historicalHighestPrice=.1,this.graphics.moveTo(0,0),this.lastOper.active=!1,this.lastOperT=null,this.lastOperDir=null,this.lastOperPrice=null,this.highestLine.position=new cc.Vec2(0,0),this.baseSpeed=1,d.MainCtrl.Instance.lastTradeHistory=[],this.isRunning=!0},t.prototype.BuyAll=function(){console.log("全仓买入");var t=d.MainCtrl.Instance.BTCHistory[this.t].close,e=Math.min(2e7-this.btcBalance,this.fiatBalance/t);this.fiatBalance<this.btcBalance*t*1e-5||(this.btcBalance+=e,this.fiatBalance-=e*t,this.lastOperT=this.t,this.lastOperDir=1,this.lastOperPrice=t,d.MainCtrl.Instance.lastTradeHistory.push([this.t,t,1,e]),this.refreshBalance())},t.prototype.SellAll=function(){console.log("全仓卖出");var t=d.MainCtrl.Instance.BTCHistory[this.t].close,e=this.btcBalance;e<this.fiatBalance/t*1e-5||(this.fiatBalance+=e*t,this.btcBalance-=e,this.lastOperT=this.t,this.lastOperDir=2,this.lastOperPrice=t,d.MainCtrl.Instance.lastTradeHistory.push([this.t,t,2,e]),this.refreshBalance())},t.prototype.update=function(t){var e=d.MainCtrl.Instance.BTCHistory;if(!(this.t>=e.length-1)){for(this.lblSpeed.string=(1*this.baseSpeed/this.interval).toFixed(),this.nextDayCountdown-=1*t*this.baseSpeed;this.nextDayCountdown<=0&&this.t<e.length-1;){this.t++,this.nextDayCountdown+=this.interval;var o=e[this.t].close;o>this.historicalHighestPrice&&(this.historicalHighestPrice=o);var n=e[this.t].news;n&&0<n.length&&this.popupNews(n)}if(!(this.t<0)){var a=e[this.t].close;this.graphics.clear();var r=.96*this.height/this.historicalHighestPrice,c=Math.max(0,this.t-Math.round(this.width/this.dayWidth));this.graphics.moveTo(0,e[c].close*r);for(var i=c+1;i<=this.t;i++)this.graphics.lineTo((i-c)*this.dayWidth,e[i].close*r);this.graphics.stroke(),this.lastOperDir?(this.lastOper.position=new cc.Vec2(Math.max(0,this.lastOperT-c)*this.dayWidth,this.lastOperPrice*r),this.lblLastOper.string=1==this.lastOperDir?"最近买入":"最近卖出",this.lastOper.active=!0):this.lastOper.active=!1,this.highestLine.position=new cc.Vec2(0,this.historicalHighestPrice*r),this.lblCurrentPrice.string="￥"+p.default.formatCNY(a*s.USD2CNY),this.currentPriceLine.position=new cc.Vec2(Math.min(this.width,this.t-c)*this.dayWidth,a*r),this.lblPrice.string="￥"+p.default.formatCNY(a*s.USD2CNY),this.lblDate.string=e[this.t].date;var l=this.fiatBalance/a+this.btcBalance;this.lblTotalAsCNY.string=p.default.formatCNY(l*a*s.USD2CNY),this.lblTotalAsBTC.string="="+p.default.formatBTC(l),this.isRunning&&this.t>=e.length-1&&(d.MainCtrl.Instance.lastScore=l,d.MainCtrl.Instance.lastPrice=a,console.log("End"),setTimeout(function(){d.MainCtrl.Instance.GotoResult()},1e3),this.isRunning=!1),this.btnBuyAll.interactable=this.isRunning&&.01<this.fiatBalance,this.btnSellAll.interactable=this.isRunning&&1e-5<this.btcBalance,this.newsOpacity=Math.max(0,this.newsOpacity-1*t),this.grpNews.opacity=255*Math.min(1,this.newsOpacity)}}},t.prototype.refreshBalance=function(){this.lblFiatBalance.setTargetNumber(Math.max(0,this.fiatBalance)*s.USD2CNY),this.lblBtcBalance.setTargetNumber(Math.max(0,this.btcBalance))},t.prototype.popupNews=function(t){this.lblNews.string=t,this.newsOpacity=4.5},t.USD2CNY=6.3,__decorate([c(cc.Label)],t.prototype,"lblPrice",void 0),__decorate([c(cc.Label)],t.prototype,"lblDate",void 0),__decorate([c(cc.Node)],t.prototype,"grpNews",void 0),__decorate([c(cc.Label)],t.prototype,"lblNews",void 0),__decorate([c(n.default)],t.prototype,"lblFiatBalance",void 0),__decorate([c(n.default)],t.prototype,"lblBtcBalance",void 0),__decorate([c(cc.Label)],t.prototype,"lblTotalAsCNY",void 0),__decorate([c(cc.Label)],t.prototype,"lblTotalAsBTC",void 0),__decorate([c(cc.Graphics)],t.prototype,"graphics",void 0),__decorate([c(cc.Node)],t.prototype,"lastOper",void 0),__decorate([c(cc.Label)],t.prototype,"lblLastOper",void 0),__decorate([c(cc.Node)],t.prototype,"highestLine",void 0),__decorate([c(cc.Node)],t.prototype,"currentPriceLine",void 0),__decorate([c(cc.Label)],t.prototype,"lblCurrentPrice",void 0),__decorate([c(cc.Button)],t.prototype,"btnBuyAll",void 0),__decorate([c(cc.Button)],t.prototype,"btnSellAll",void 0),__decorate([c(cc.Label)],t.prototype,"lblSpeed",void 0),__decorate([c([cc.Button])],t.prototype,"btnSpeeds",void 0),t=s=__decorate([r],t);var s}(cc.Component);o.CoreUI=i,cc._RF.pop()},{"./BalanceFormatter":"BalanceFormatter","./MainCtrl":"MainCtrl","./MoneyLabel":"MoneyLabel"}],Helloworld:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Helloworld"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=n.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return __extends(t,e),t.prototype.start=function(){this.label.string=this.text},__decorate([r(cc.Label)],t.prototype,"label",void 0),__decorate([r],t.prototype,"text",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],HomeUI:[function(t,e,o){"use strict";cc._RF.push(e,"6b88eEl0rxJlafriia9L0dd","HomeUI"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./MainCtrl"),a=cc._decorator,r=a.ccclass,c=a.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnDonate=null,t.btnInstallWallet=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.btnDonate.node.active=!1,this.btnInstallWallet.node.active=!0},t.prototype.onEnable=function(){n.MainCtrl.Instance.checkWallet()},t.prototype.onInstallWalletBtnClick=function(){window.open("https://github.com/ChengOrangeJu/WebExtensionWallet")},t.prototype.update=function(){window.webExtensionWallet?(this.btnDonate.node.active=!0,this.btnInstallWallet.node.active=!1):(this.btnDonate.node.active=!1,this.btnInstallWallet.node.active=!0)},t.firstTime=!0,__decorate([c(cc.Button)],t.prototype,"btnDonate",void 0),__decorate([c(cc.Button)],t.prototype,"btnInstallWallet",void 0),t=__decorate([r],t)}(cc.Component);o.default=i,cc._RF.pop()},{"./MainCtrl":"MainCtrl"}],Leaderboard:[function(t,e,o){"use strict";cc._RF.push(e,"8c6944j/7xE5Zvme1I3sc/D","Leaderboard"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./BalanceFormatter"),i=t("./MainCtrl"),a=cc._decorator,r=a.ccclass,l=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.template=null,t.container=null,t.elements=[],t.tab="score",t}return __extends(t,e),(c=t).prototype.onLoad=function(){this.setAndRefreshElement("*",this.template,null);for(var t=0;t<c.ElementCount;t++){var e=cc.instantiate(this.template);(this.elements[t]=e).parent=this.container,e.name=t.toFixed(),this.setAndRefreshElement(t,e,null)}},t.prototype.onEnable=function(){this.fetchData(),this.switchTab(null,"score")},t.prototype.fetchData=function(){var e=this;if(Neb){var t=new Neb;t.setRequest(new HttpRequest(i.MainCtrl.BlockchainUrl));var o=i.MainCtrl.Instance.wallet_address?i.MainCtrl.Instance.wallet_address:Account.NewAccount().getAddressString();console.log("from:"+o);var n="1000000",a="2000000",r={function:"get_score_rankboard",args:"[]"};t.api.call(o,i.ContractAddress,"0","0",n,a,r).then(function(t){console.log("get_score_rankboard",t),c.scoreBoard=JSON.parse(t.result).result_data,e.switchTab(null,"score")}).catch(function(t){console.log("error:"+t.message)});r={function:"get_donation_rankboard",args:"[]"};t.api.call(o,i.ContractAddress,"0","0",n,a,r).then(function(t){console.log("get_donation_rankboard",t),c.donationBoard=JSON.parse(t.result).result_data,e.switchTab(null,"donation")}).catch(function(t){console.log("error:"+t.message)});r={function:"get_player_info",args:"[]"};t.api.call(o,i.ContractAddress,"0","0",n,a,r).then(function(t){console.log("get_player_info",t),e.setAndRefreshElement("*",e.template,JSON.parse(t.result).result_data)}).catch(function(t){console.log("error:"+t.message)})}},t.prototype.setAndRefreshElement=function(t,e,o){o?(e.getChildByName("LblAddress").getComponent(cc.Label).string=t+"  "+o.address,e.getChildByName("LblScore").getComponent(cc.Label).string="分数"+n.default.formatBTC(o.score)+"BTC",e.getChildByName("LblDonation").getComponent(cc.Label).string="捐赠"+n.default.formatNAS(Number(o.donation)/1e18)+"NAS",e.getChildByName("LblComment").getComponent(cc.Label).string=o.comment):(e.getChildByName("LblAddress").getComponent(cc.Label).string=t.toString(),e.getChildByName("LblScore").getComponent(cc.Label).string="",e.getChildByName("LblDonation").getComponent(cc.Label).string="",e.getChildByName("LblComment").getComponent(cc.Label).string="")},t.prototype.switchTab=function(t,e){switch(e){case"score":console.log("tab",e);for(var o=0;o<this.elements.length;o++){var n=this.elements[o];this.setAndRefreshElement(o,n,o<c.scoreBoard.length?c.scoreBoard[o]:null)}break;case"donation":for(o=0;o<this.elements.length;o++){n=this.elements[o];this.setAndRefreshElement(o,n,o<c.donationBoard.length?c.donationBoard[o]:null)}}},t.ElementCount=20,t.scoreBoard=[{address:"正在获取数据，请稍候……",score:0,donation:0,comment:""}],t.donationBoard=[{address:"正在获取数据，请稍候……",score:0,donation:0,comment:""}],__decorate([l(cc.Node)],t.prototype,"template",void 0),__decorate([l(cc.Node)],t.prototype,"container",void 0),t=c=__decorate([r],t);var c}(cc.Component);o.default=c,cc._RF.pop()},{"./BalanceFormatter":"BalanceFormatter","./MainCtrl":"MainCtrl"}],MainCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e4b263diNNBEoO04d4lNHHp","MainCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./CoreUI"),a=cc._decorator,r=a.ccclass,i=a.property;o.ContractAddress="n1vMo7fEcQ18gLDAq8GutcgoyXUyEGDFtQm",o.EncKey=37234;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BTCHistory=null,t.lastScore=0,t.lastPrice=0,t.lastTradeHistory=[],t.UIContainer=null,t.HomeUI=null,t.CoreUI=null,t.ResultUI=null,t.LeaderboardUI=null,t.UploadUI=null,t}return __extends(t,e),(c=t).prototype.onLoad=function(){c.Instance=this,document.title="NAS|币圈穿越记",c.BlockchainUrl="https://mainnet.nebulas.io",console.log("BlockchainUrl",c.BlockchainUrl),cc.loader.loadRes("BTC",function(t,e){console.log("BTCHistory loaded"),this.BTCHistory=e,this.fetchLatestData()}.bind(this))},t.prototype.start=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.HomeUI.active=!0},t.prototype.checkWallet=function(){try{var e=this,t=new Neb;t.setRequest(new HttpRequest(c.BlockchainUrl)),t.api.getNebState().then(function(t){e.nebState=t,window.addEventListener("message",e.getMessage),window.postMessage({target:"contentscript",data:{},method:"getAccount"},"*")})}catch(t){console.error(t)}},t.prototype.getMessage=function(t){if(t.data&&t.data.data&&t.data.data.account){var e=t.data.data.account;c.Instance.wallet_address=e}},t.prototype.OnBtnStartClick=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.CoreUI.active=!0,this.CoreUI.getComponent(n.CoreUI).restart()},t.prototype.GotoResult=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.ResultUI.active=!0},t.prototype.GotoLeaderboard=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.LeaderboardUI.active=!0},t.prototype.GotoDonate=function(){this.lastScore=0,this.UIContainer.children.forEach(function(t){t.active=!1}),this.UploadUI.active=!0},t.prototype.GotoUpload=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.UploadUI.active=!0},t.prototype.GotoHome=function(){this.UIContainer.children.forEach(function(t){t.active=!1}),this.HomeUI.active=!0},t.prototype.fetchLatestData=function(){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&200<=r.status&&r.status<400){var t=JSON.parse(r.responseText);console.log("fetchLatestData",t);for(var e=t.Data,o=0;o<e.length;o++){var n=new Date(1e3*e[o].time),a=n.getUTCFullYear()+"/"+(n.getUTCMonth()+1)+"/"+n.getUTCDate();c.Instance.BTCHistory.push({date:a,close:e[o].close})}}};var t=c.Instance.BTCHistory,e=new Date,o=new Date(t[t.length-1].date),n=((e-o)/864e5-1).toFixed();console.log(Number(o),"md",n),r.open("GET","https://min-api.cryptocompare.com/data/histoday?fsym=BTC&tsym=USD&limit="+n+"&aggregate=1&e=CCCAGG",!0),r.send()},__decorate([i(cc.Node)],t.prototype,"UIContainer",void 0),__decorate([i(cc.Node)],t.prototype,"HomeUI",void 0),__decorate([i(cc.Node)],t.prototype,"CoreUI",void 0),__decorate([i(cc.Node)],t.prototype,"ResultUI",void 0),__decorate([i(cc.Node)],t.prototype,"LeaderboardUI",void 0),__decorate([i(cc.Node)],t.prototype,"UploadUI",void 0),t=c=__decorate([r],t);var c}(cc.Component);o.MainCtrl=c,cc._RF.pop()},{"./CoreUI":"CoreUI"}],MoneyLabel:[function(t,e,o){"use strict";cc._RF.push(e,"2afa2+9w3RB3LyF+/jl2t/+","MoneyLabel"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=n.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.transitionTime=.3,t.startNumber=0,t.targetNumber=0,t.currentNumber=0,t.countdown=t.transitionTime,t}return __extends(t,e),t.prototype.setTargetNumber=function(t){this.startNumber=this.targetNumber,this.targetNumber=t,this.countdown=this.transitionTime},t.prototype.update=function(t){if(0<this.countdown){this.countdown-=t,0<this.countdown?this.currentNumber=this.startNumber*this.countdown/this.transitionTime+this.targetNumber*(1-this.countdown/this.transitionTime):this.currentNumber=this.targetNumber;var e=this.formatterFunc?this.formatterFunc(this.currentNumber):this.currentNumber.toString();this.label&&(this.label.string=e)}},__decorate([r(cc.Label)],t.prototype,"label",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],ResultUI:[function(t,e,o){"use strict";cc._RF.push(e,"821deNcGNFGUrcGhvxyRLk4","ResultUI"),Object.defineProperty(o,"__esModule",{value:!0});var d=t("./MainCtrl"),p=t("./BalanceFormatter"),h=t("./CoreUI"),n=cc._decorator,a=n.ccclass,r=n.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lblTotalBTC=null,t.lblTotalCNY=null,t.lblTitle=null,t.tradeTemplate=null,t.tradeContainer=null,t.trades=[],t.intervals=[1,2,2,2,2,2,2,2,2],t}return __extends(t,e),t.prototype.onEnable=function(){var t=d.MainCtrl.Instance.lastScore;this.lblTotalBTC.string=p.default.formatBTC(t),this.lblTotalCNY.string="=￥"+p.default.formatCNY(t*d.MainCtrl.Instance.lastPrice*h.CoreUI.USD2CNY);for(var e=this.node.children,o=0,n=0;n<e.length;n++){var a=e[n];a.opacity=0,o+=n<this.intervals.length?this.intervals[n]:0;var r=cc.sequence(cc.delayTime(o),cc.fadeIn(.5));a.runAction(r)}var c=d.MainCtrl.Instance.lastTradeHistory,i=d.MainCtrl.Instance.BTCHistory;this.lblTitle.string=this.calcTitle(t,i[i.length-1].close,c);20<c.length&&c.splice(5,c.length-20,"......(省略"+(c.length-20)+"条记录)");for(n=0;n<c.length;n++){var l=c[n],s=cc.instantiate(this.tradeTemplate);s.parent=this.tradeContainer,"string"!=typeof l?(s.getChildByName("LblDate").getComponent(cc.Label).string=i[l[0]].date,s.getChildByName("LblPrice").getComponent(cc.Label).string="￥"+p.default.formatCNY(l[1]),s.getChildByName("LblDirection").getComponent(cc.Label).string=1==l[2]?"买":"卖",s.getChildByName("LblAmount").getComponent(cc.Label).string=p.default.formatBTC(l[3])+"BTC"):(s.getChildByName("LblDate").getComponent(cc.Label).string=l,s.getChildByName("LblPrice").getComponent(cc.Label).string="",s.getChildByName("LblDirection").getComponent(cc.Label).string="",s.getChildByName("LblAmount").getComponent(cc.Label).string=""),s.active=!0}this.tradeTemplate.active=!1,d.MainCtrl.Instance.checkWallet()},t.prototype.calcTitle=function(t,e,o){o[o.length-1];return this.isTakongDog(t,e,o)?"踏空狗":t*e*h.CoreUI.USD2CNY<100?"归零膏":.7*o[0][3]>t&&o.length<15?"追涨杀跌的韭菜":.7*o[0][3]>t&&15<=o.length?"神操作韭菜":o.length<4&&200<t?"价值投资者":1==o.length&&10<t?"比特币信徒":0==o.length?"被时代抛弃的人":this.isBuoduanPrince(t,e,o)?"波段小王子":this.isGouzhuang(t,e,o)?"狗庄":1e3<o[0][0]?"后知后觉者":1e7<=t?"神":1e6<=t?"中本次郎":1e5<=t?"先知":1e4<=t?"神级操盘手":t>1.1*o[0][3]?"操盘手":10<=t?"高级韭菜":"韭菜"},t.prototype.isTakongDog=function(t,e,o){if(t<300&&o.length<8)for(var n=1;n<o.length;n++){var a=o[n],r=o[n-1];if(2==r[2]&&1==a[2]&&5*r[1]<=a[1])return!0}},t.prototype.isBuoduanPrince=function(t,e,o){for(var n,a=1;a<o.length;a++){var r=o[a],c=o[a-1];1==c[2]&&2==r[2]&&c[1]<r[1]?n++:2==c[2]&&1==r[2]&&c[1]>r[1]?n++:0}return n>=.8*(o.length-1)},t.prototype.isGouzhuang=function(t,e,o){var n,a;if(1e3<t){for(var r=1;r<o.length;r++){var c=o[r],i=o[r-1];1==i[2]&&2==c[2]&&(i[1]<c[1]&&c[0]-i[0]<100?n++:a++)}if(.7*(n+a)<n)return!0}return!1},__decorate([r(cc.Label)],t.prototype,"lblTotalBTC",void 0),__decorate([r(cc.Label)],t.prototype,"lblTotalCNY",void 0),__decorate([r(cc.Label)],t.prototype,"lblTitle",void 0),__decorate([r(cc.Node)],t.prototype,"tradeTemplate",void 0),__decorate([r(cc.Node)],t.prototype,"tradeContainer",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./BalanceFormatter":"BalanceFormatter","./CoreUI":"CoreUI","./MainCtrl":"MainCtrl"}],UploadUI:[function(t,e,o){"use strict";cc._RF.push(e,"7f006caj/dGN5O0ODkhK1Hx","UploadUI"),Object.defineProperty(o,"__esModule",{value:!0});var p=t("./MainCtrl"),n=t("./BalanceFormatter"),a=cc._decorator,r=a.ccclass,c=a.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lblTotalBTC=null,t.edtComment=null,t.edtDonate=null,t.grpWithScore=null,t.grpNoScore=null,t.lblSend=null,t}return __extends(t,e),(d=t).prototype.onEnable=function(){var t=p.MainCtrl.Instance.lastScore;t?(this.lblTotalBTC.string=n.default.formatBTC(t),this.grpWithScore.active=!0,this.grpNoScore.active=!1,this.lblSend.string="上传到时间机器"):(this.grpWithScore.active=!1,this.grpNoScore.active=!0,this.lblSend.string="发送捐赠")},t.prototype.onBackBtnClick=function(){p.MainCtrl.Instance.GotoResult()},t.prototype.onUploadBtnClick=function(){if(window.webExtensionWallet)try{var t=p.MainCtrl.Instance.lastScore,e=parseFloat(this.edtDonate.string),o=this.edtComment.string,n=[];p.MainCtrl.Instance.lastTradeHistory.forEach(function(t){n.push(10*t[0]+t[2])});var a=new NebPay,r=p.MainCtrl.BlockchainUrl,c=p.ContractAddress,i=e,l=d.encrypto(t.toString(),p.EncKey,25);console.log("调用钱包",t,e,o,n,l);var s='["'+l+'","'+o+'",['+n.toString()+"]]";a.call(c,i,"submit",s,{qrcode:{showQRCode:!1},goods:{name:"test",desc:"test goods"},callback:r,listener:this.listener})}catch(t){console.error(t)}else window.open("https://github.com/ChengOrangeJu/WebExtensionWallet")},t.prototype.listener=function(t){console.log("submit resp: ",t),"Error"!=t.toString().substr(0,5)&&p.MainCtrl.Instance.GotoHome()},t.encrypto=function(t,e,o){if("string"==typeof t&&"number"==typeof e&&"number"==typeof o){var n=[];o=o<=25?o:o%25;for(var a=0;a<t.length;a++){var r=t.charCodeAt(a);r=(r=1*r^e).toString(o),n.push(r)}var c=String.fromCharCode(o+97);return n.join(c)}},__decorate([c(cc.Label)],t.prototype,"lblTotalBTC",void 0),__decorate([c(cc.EditBox)],t.prototype,"edtComment",void 0),__decorate([c(cc.EditBox)],t.prototype,"edtDonate",void 0),__decorate([c(cc.Node)],t.prototype,"grpWithScore",void 0),__decorate([c(cc.Node)],t.prototype,"grpNoScore",void 0),__decorate([c(cc.Label)],t.prototype,"lblSend",void 0),t=d=__decorate([r],t);var d}(cc.Component);o.default=i,cc._RF.pop()},{"./BalanceFormatter":"BalanceFormatter","./MainCtrl":"MainCtrl"}]},{},["BalanceFormatter","CoreUI","Helloworld","HomeUI","Leaderboard","MainCtrl","MoneyLabel","ResultUI","UploadUI"]);